<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dashboard Laporan</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="container">
    <h1>Dashboard Laporan</h1>
    <div id="board">Memuat...</div>
  </main>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbycJc7oMgPazk-IPfeE7F7GaFsMK9NWZM6bylP91rP8kgtqP07XH6goyqGltE32jIl6/exec";

async function load(){
  const r = await fetch(GAS_URL + '?action=list');
  const j = await r.json();
  const data = j.data || [];
  const el = document.getElementById('board');
  if(!data.length){ el.innerHTML = '<p>Belum ada laporan.</p>'; return; }
  el.innerHTML = '<table class="table"><thead><tr><th>No</th><th>Tanggal</th><th>Nama</th><th>Divisi</th><th>Kendala</th><th>Teknisi</th><th>Status</th></tr></thead><tbody>'
  + data.map((row,i)=>`<tr>
    <td>${i+1}</td>
    <td>${row.tanggal} ${row.jam}</td>
    <td>${row.nama}</td>
    <td>${row.divisi}</td>
    <td>${row.jenis}<br/><small>${row.deskripsi}</small></td>
    <td>${row.teknisi || '-'}</td>
    <td>${row.status || 'Masuk'}</td>
  </tr>`).join('') + '</tbody></table>';
}
load();
setInterval(load, 30_000); // refresh 30 detik
</script>
</body>
</html>
