<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dashboard Laporan</title>
<link rel="stylesheet" href="assets/css/dashboard.css">
<link rel="manifest" href="manifest.json" />
<style>
  #laporanTable th:nth-child(1),
  #laporanTable td:nth-child(1) {
      display: none;
  }
  /* Running text */
  .running-text {
    background: #0057ff;
    color: white;
    padding: 8px;
    font-size: 16px;
    white-space: nowrap;
    overflow: hidden;
    box-sizing: border-box;
  }
  .running-text span {
    display: inline-block;
    padding-left: 100%;
    animation: scroll-left 15s linear infinite;
  }
  @keyframes scroll-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }
</style>
</head>
<body>
<header>
  <h1>Dashboard Laporan</h1>
  <p>Progres laporan real-time</p>
</header>

<!-- Running Text: Laporan hari ini -->
<div class="running-text">
  <span id="runningText">Memuat laporan hari ini...</span>
</div>

<main>
  <div class="summary-wrapper">
    <div class="summary-card total">
      <h3>Total Laporan</h3>
      <p id="sumTotal">0</p>
    </div>
    <div class="summary-card selesai">
      <h3>Selesai</h3>
      <p id="sumDone">0</p>
    </div>
    <div class="summary-card proses">
      <h3>Diproses</h3>
      <p id="sumProcess">0</p>
    </div>
  </div>

  <div class="card">
    <h3>Progress Penyelesaian</h3>
    <p id="progressText">Menghitung...</p>
    <div class="progress-bg">
      <div id="progressBar" class="progress-fill"></div>
    </div>
  </div>

  <div class="card">
    <table id="laporanTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Waktu</th>
          <th>Nama</th>
          <th>Ruangan</th>
          <th>Keterangan</th>
          <th>Foto</th>
          <th>Status</th>
          <th>Petugas</th>
          <th>Catatan</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="9" style="text-align:center">Memuat data...</td></tr>
      </tbody>
    </table>
  </div>
</main>

<script src="assets/js/dashboard-public.js" defer></script>
<script>
// Update running text setelah data laporan di-load dari dashboard-public.js
function updateRunningText(laporan) {
  const today = new Date().toLocaleDateString('en-CA'); // format YYYY-MM-DD sesuai tanggal HP/laptop('T')[0];
  const const todayReports = laporan.filter(item => item.waktu.startsWith(today));

  let text = "";
  if (todayReports.length === 0) {
    text = "Belum ada laporan masuk hari ini";
  } else {
    text = todayReports.map(r => `${r.waktu} â†’ ${r.nama} (${r.ruangan}) melapor: ${r.keterangan}`).join("   |   ");
  }
  document.getElementById("runningText").textContent = text;
}
</script>
</body>
</html>
